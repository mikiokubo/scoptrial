---

title: 制約最適化システム SCOP


keywords: fastai
sidebar: home_sidebar

summary: "Coonstraint Programming Solver SCOP "
description: "Coonstraint Programming Solver SCOP "
nb_path: "14scop.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 14scop.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ドキュメント</p>
<ul>
<li><a href="https://mikiokubo.github.io/scmopt/14scop/">https://mikiokubo.github.io/scmopt/14scop/</a></li>
</ul>
<p>SCOP（Solver forCOnstraint Programing：スコープ）は，
大規模な制約最適化問題を高速に解くためのソルバーである．</p>
<p>ここで，制約最適化(constraint optimization)
数理最適化を補完する最適化理論の体系であり，
組合せ最適化問題に特化した求解原理-メタヒューリスティクス(metaheuristics)-を用いるため，
数理最適化ソルバーでは求解が困難な大規模な問題に対しても，効率的に良好な解を探索することができる．</p>
<p>このモジュールは， すべてPythonで書かれたクラスで構成されている．
SCOPのトライアルバージョンは， <a href="http://logopt.com/scop2/">http://logopt.com/scop2/</a> からダウンロードできる．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#37325;&#12415;&#20184;&#12365;&#21046;&#32004;&#20805;&#36275;&#21839;&#38988;">&#37325;&#12415;&#20184;&#12365;&#21046;&#32004;&#20805;&#36275;&#21839;&#38988;<a class="anchor-link" href="#&#37325;&#12415;&#20184;&#12365;&#21046;&#32004;&#20805;&#36275;&#21839;&#38988;"> </a></h2><p>ここでは，SCOPで対象とする重み付き制約充足問題について解説する．</p>
<p>一般に<strong>制約充足問題</strong>(constraint satisfaction problem)は，以下の3つの要素から構成される．</p>
<ul>
<li><p>変数(variable): 分からないもの，最適化によって決めるもの．
制約充足問題では，変数は，与えられた集合（以下で述べる「領域」）から1つの要素を選択することによって決められる．</p>
</li>
<li><p>領域(domain): 変数ごとに決められた変数の取り得る値の集合．</p>
</li>
<li><p>制約(constraint): 幾つかの変数が同時にとることのできる値に制限を付加するための条件．
SCOPでは線形制約（線形式の等式，不等式），2次制約（一般の2次式の等式，不等式），
相異制約（集合に含まれる変数がすべて異なることを表す制約）が定義できる．</p>
</li>
</ul>
<p>制約充足問題は，制約をできるだけ満たすように，
変数に領域の中の1つの値を割り当てることを目的とした問題である．</p>
<p>SCOPでは，<strong>重み付き制約充足問題</strong>(weighted constraint satisfaction problem)
を対象とする．</p>
<p>ここで「制約の重み」とは，制約の重要度を表す数値であり，
SCOPでは正数値もしくは無限大を表す文字列 'inf'を入力する．
'inf'を入力した場合には，制約は<strong>絶対制約</strong>(hard constraint)とよばれ，
その逸脱量は優先して最小化される．
重みに正数値を入力した場合には，制約は<strong>考慮制約</strong>(soft constraint)とよばれ，
制約を逸脱した量に重みを乗じたものの和の合計を最小化する．</p>
<p>すべての変数に領域内の値を割り当てたものを<strong>解</strong>(solution)とよぶ．
SCOPでは，単に制約を満たす解を求めるだけでなく，
制約からの逸脱量の重み付き和（ペナルティ）を最小にする解を探索する．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SCOP&#12514;&#12472;&#12517;&#12540;&#12523;&#12398;&#22522;&#26412;&#12463;&#12521;&#12473;">SCOP&#12514;&#12472;&#12517;&#12540;&#12523;&#12398;&#22522;&#26412;&#12463;&#12521;&#12473;<a class="anchor-link" href="#SCOP&#12514;&#12472;&#12517;&#12540;&#12523;&#12398;&#22522;&#26412;&#12463;&#12521;&#12473;"> </a></h2><p>SCOPは，以下のクラスから構成されている．</p>
<ul>
<li>モデルクラス Model</li>
<li>変数クラス Variable</li>
<li><p>制約クラス Constraint (これは，以下のクラスのスーパークラスである．）</p>
<ul>
<li>線形制約クラス Linear</li>
<li>2次制約クラス Quadratic</li>
<li>相異制約クラス Alldiff</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#27880;&#24847;">&#27880;&#24847;<a class="anchor-link" href="#&#27880;&#24847;"> </a></h2><p>SCOPでは数（制約）名や値を文字列で区別するため重複した名前を付けることはできない．
なお，使用できる文字列は, 英文字 (a--z, A--Z), 
数字 (0--9), 大括弧 ([ ]),<br>
アンダーバー (_), および @ に限定される．</p>
<p>それ以外の文字列はすべてアンダーバー (_)に置き換えられる．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#26368;&#36969;&#21270;&#12398;&#25551;&#30011;&#38306;&#25968;-plot_scop">&#26368;&#36969;&#21270;&#12398;&#25551;&#30011;&#38306;&#25968; plot_scop<a class="anchor-link" href="#&#26368;&#36969;&#21270;&#12398;&#25551;&#30011;&#38306;&#25968;-plot_scop"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_scop" class="doc_header"><code>plot_scop</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_scop</code>(<strong><code>file_name</code></strong>:<code>str</code>=<em><code>'scop_out.txt'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plot_scop</span><span class="p">()</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parameters&#12463;&#12521;&#12473;">Parameters&#12463;&#12521;&#12473;<a class="anchor-link" href="#Parameters&#12463;&#12521;&#12473;"> </a></h2><p>Parametersクラスで設定可能なパラメータは，以下の通り．</p>
<ul>
<li><p>TimeLimit は制限時間を表す．制限時間は正数値を設定する必要があり，その既定値は 600秒である．</p>
</li>
<li><p>OutputFlag は出力フラグを表し，最適化の過程を出力する際の詳細さを制御するためのパラメータである．
真(True もしくは正の値)に設定すると詳細な情報を出力し，
偽(False もしくは 0)に設定すると最小限の情報を出力する．
既定値は偽(0)である．</p>
</li>
<li><p>RandomSeed は乱数の種である．SCOPでは探索にランダム性を加味しているので，乱数の種を変えると，得られる解が変わる可能性がある．
乱数の種の既定値は 1である．</p>
</li>
<li><p>Target は制約の逸脱量が目標値以下になったら自動終了させるためのパラメータである．
既定値は 0 である．</p>
</li>
<li><p>Initial は，前回最適化の探索を行った際の最良解を初期値とした探索を行うとき True ，それ以外のとき  False を表すパラメータである．
既定値は False である．最良解の情報は，「変数:値」を1行としたテキストとしてファイル名 scop_best_data.txt に保管されている．
このファイルを書き換えることによって，異なる初期解から探索を行うことも可能である．</p>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Parameters" class="doc_header"><code>class</code> <code>Parameters</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L64" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Parameters</code>()</p>
</blockquote>
<p>SCOP parameter class to control the operation of SCOP.</p>
<ul>
<li>TimeLimit: Limits the total time expended (in seconds). Positive integer. Default = 600.</li>
<li>OutputFlag: Controls the output log. Boolean. Default = False.</li>
<li>RandomSeed: Sets the random seed number. Integer. Default = 1.</li>
<li>Target: Sets the target penalty value;
<pre><code>  optimization will terminate if the solver determines that the optimum penalty value
  for the model is worse than the specified "Target." Non-negative integer. Default = 0.</code></pre>
</li>
<li>Initial: True if you want to solve the problem starting with an initial solution obtained before, False otherwise. Default = False.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parameters&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;">Parameters&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;<a class="anchor-link" href="#Parameters&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">TimeLimit</span> <span class="o">=</span> <span class="mi">3</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> TimeLimit = 3 
 OutputFlag = 0 
 RandomSeed = 1 
 Taeget = 0 
 Initial = False
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#22793;&#25968;&#12463;&#12521;&#12473;-Variable">&#22793;&#25968;&#12463;&#12521;&#12473; Variable<a class="anchor-link" href="#&#22793;&#25968;&#12463;&#12521;&#12473;-Variable"> </a></h2><p>変数クラス Variable のインスタンスは，モデルインスタンスの addVariable もしくは addVariables メソッドを
用いて生成される．</p>
<div class="highlight"><pre><span></span><span class="n">変数インスタンス</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">domain</span><span class="err">）</span>
</pre></div>
<p>引数の  name は変数名を表す文字列であり，
  domain は領域を表すリストである．</p>
<div class="highlight"><pre><span></span><span class="n">変数インスタンスのリスト</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">addVariables</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">domain</span><span class="err">）</span>
</pre></div>
<p>引数の  names は変数名を要素としたリストであり，  domain は領域を表すリストである．</p>
<p>変数クラスは，以下の属性をもつ．</p>
<ul>
<li>name は変数の名称である．</li>
<li>domain は変数の領域(domain)を表すリストである．変数には領域に含まれる値(value)のうちの1つが割り当てられる．</li>
<li>value は最適化によって変数に割り当てられた値である．最適化が行われる前には  None が代入されている．</li>
</ul>
<p>また，変数インスタンスは，変数の情報を文字列として返すことができる．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Variable" class="doc_header"><code>class</code> <code>Variable</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L86" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Variable</code>(<strong><code>name</code></strong>=<em><code>''</code></em>, <strong><code>domain</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>SCOP variable class. Variables are associated with a particular model.
You can create a variable object by adding a variable to a model (using Model.addVariable or Model.addVariables)
instead of by using a Variable constructor.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Variable&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;">Variable&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;<a class="anchor-link" href="#Variable&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;X[1]&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>variable X[1]:[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;] = None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var1</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">var2</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>variable __x0:[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;] = None
variable __x1:[&#39;4&#39;, &#39;5&#39;, &#39;6&#39;] = None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">var1</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Variable name must be a string
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#12514;&#12487;&#12523;&#12463;&#12521;&#12473;">&#12514;&#12487;&#12523;&#12463;&#12521;&#12473;<a class="anchor-link" href="#&#12514;&#12487;&#12523;&#12463;&#12521;&#12473;"> </a></h2><p>PythonからSCOPをよび出して使うときに，最初にすべきことはモデルクラス Model のインスタンスを生成することである．
たとえば，  'test' と名付けたモデルインスタンス  model を生成したいときには，以下のように記述する．</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scop</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
<p>インスタンスの引数はモデル名であり，省略すると無名のモデルが生成される．</p>
<p>Model クラスは，以下のメソッドをもつ．</p>
<ul>
<li>addVariable(name，domain) はモデルに1つの変数を追加する．
引数の name は変数名を表す文字列であり，domain は領域を表すリストである．
変数名を省略すると，自動的に  __x[ 通し番号  ] という名前が付けられる．</li>
</ul>
<p>領域を定義するためのリスト domain の要素は，文字列でも数値でもかまわない．
（ただし内部表現は文字列であるので，両者は区別されない．）</p>
<p>以下に例を示す．</p>
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">addVarriable</span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">)</span>                     <span class="c1"># domain  is set to [] </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># arguments by name</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">,[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>        <span class="c1"># arguments by position</span>
</pre></div>
<p>1行目の例では，変数名を  'var' と設定した空の領域をもつ変数を追加している．
2行目の例では，名前付き引数で変数名と領域を設定している．領域は  1,2,3 の数値である．
3行目の例では，領域を文字列として変数を追加している．</p>
<ul>
<li><p>addVariables(names,domain) はモデルに，同一の領域をもつ複数の変数を同時に追加する．
引数の  names は変数名を要素としたリストであり，domain は領域を表すリストである．
領域を定義するためのリストの要素は，文字列でも数値でもかまわない．</p>
</li>
<li><p>addConstriant(con) は制約インスタンス  con をモデルに追加する．
制約インスタンスは，制約クラスを用いて生成されたインスタンスである．制約インスタンスの生成法については，
以下で解説する．</p>
</li>
<li><p>optimize はモデルの求解（最適化）を行うメソッドである．
最適化のためのパラメータは，パラメータ属性  Params で設定する．
返値は，最適解の情報を保管した辞書と，破った制約の情報を保管した辞書のタプルである．</p>
</li>
</ul>
<p>たとえば，以下のプログラムでは最適解を辞書  sol に，破った制約を辞書  violated に保管する．</p>
<div class="highlight"><pre><span></span><span class="n">sol</span><span class="p">,</span><span class="n">violated</span><span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
<p>最適解や破った制約は，変数や制約の名前をキーとし，解の値や制約逸脱量を値とした辞書であるので，
最適解の値と逸脱量を出力するには，以下のように記述すれば良い．</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sol</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">violated</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">violated</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</pre></div>
<p>モデルインスタンスは，以下の属性をもつ．</p>
<ul>
<li>name はモデルの名前である．コンストラクタの引数として与えられる．省略可で既定値は ' ' である．</li>
<li>variables は変数インスタンスのリストである．</li>
<li>constraints は制約インスタンスのリストである．</li>
<li>varDict は制約名をキーとし，変数インスタンスを値とした辞書である．</li>
<li>Params は求解（最適化）の際に用いるパラメータを表す属性を保管する．</li>
<li>Status は最適化の状態を表す整数である．状態の種類と意味を以下の表に示す．</li>
</ul>
<p>最適化の状態を表す整数と意味</p>
<table>
<thead><tr>
<th>状態の定数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>最適化成功</td>
</tr>
<tr>
<td>1</td>
<td>求解中にユーザが  Ctrl-C を入力したことによって強制終了した．</td>
</tr>
<tr>
<td>2</td>
<td>入力データファイルの読み込みに失敗した．</td>
</tr>
<tr>
<td>3</td>
<td>初期解ファイルの読み込みに失敗した．</td>
</tr>
<tr>
<td>4</td>
<td>ログファイルの書き込みに失敗した．</td>
</tr>
<tr>
<td>5</td>
<td>入力データの書式にエラーがある．</td>
</tr>
<tr>
<td>6</td>
<td>メモリの確保に失敗した．</td>
</tr>
<tr>
<td>7</td>
<td>実行ファイル  scop.exe のよび出しに失敗した．</td>
</tr>
<tr>
<td>10</td>
<td>モデルの入力は完了しているが，まだ最適化されていない．</td>
</tr>
<tr>
<td>負の値</td>
<td>その他のエラー</td>
</tr>
</tbody>
</table>
<p>また，モデルインスタンスは，モデルの情報を文字列として返すことができる．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Model" class="doc_header"><code>class</code> <code>Model</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L112" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Model</code>(<strong><code>name</code></strong>=<em><code>''</code></em>)</p>
</blockquote>
<p>SCOP model class.</p>
<p>Attbibutes:</p>
<ul>
<li>constraints: Set of constraint objects in the model.</li>
<li>variables: Set of variable objects in the model.</li>
<li>Params:  Object including all the parameters of the model.</li>
<li>varDict: Dictionary that maps variable names to the variable object.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;">Model&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;<a class="anchor-link" href="#Model&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x[1]&quot;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">Params</span><span class="o">.</span><span class="n">TimeLimit</span><span class="o">=</span> <span class="mi">1</span>
<span class="n">sol</span><span class="p">,</span> <span class="n">violated</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;solution=&quot;</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;violated constraints=&quot;</span><span class="p">,</span> <span class="n">violated</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model:test 
number of variables = 1  
number of constraints= 0  
variable x[1]:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = None

 ================ Now solving the problem ================ 

solution= {&#39;x[1]&#39;: &#39;0&#39;}
violated constraints= {}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#21046;&#32004;&#12463;&#12521;&#12473;">&#21046;&#32004;&#12463;&#12521;&#12473;<a class="anchor-link" href="#&#21046;&#32004;&#12463;&#12521;&#12473;"> </a></h2><p>制約クラスは，以下で定義する線形制約クラス，2次制約クラス，相異制約クラスの基底クラスである．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Constraint" class="doc_header"><code>class</code> <code>Constraint</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L408" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Constraint</code>(<strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>weight</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>Constraint base class</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#32218;&#24418;&#21046;&#32004;&#12463;&#12521;&#12473;">&#32218;&#24418;&#21046;&#32004;&#12463;&#12521;&#12473;<a class="anchor-link" href="#&#32218;&#24418;&#21046;&#32004;&#12463;&#12521;&#12473;"> </a></h2><p>最も基本的な制約は，線形制約である．
線形制約は
$$
  線形項1 + 線形項2 + \cdots  制約の方向 (\leq, \geq, =) 右辺定数
$$
の形で与えられる．線形項は，「変数」が「値」をとったとき $1$，
それ以外のとき $0$ を表す<strong>値変数</strong>(value variable) $x[変数,値]$ を用いて，
$$
 係数 \times x[変数,値] 
$$
で与えられる．</p>
<p>ここで，係数ならびに右辺定数は整数とし，制約の方向は
以下($\leq$)，以上($\geq$)，等しい($=$)から1つを選ぶ必要がある．</p>
<p>線形制約クラス  Linear のインスタンスは，以下のように生成する．</p>
<div class="highlight"><pre><span></span><span class="n">線形制約インスタンス</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">)</span>
</pre></div>
<p>引数の意味は以下の通り．</p>
<ul>
<li><p>name は制約の名前を表す．これは制約を区別するための名称であり，固有の名前を文字列で入力する必要がある．
（名前が重複した場合には，前に定義した制約が無視される．）
名前を省略した場合には，自動的に  __CON[ 通し番号  ] という名前が付けられる．
これは，以下の2次制約や相異制約でも同じである．</p>
</li>
<li><p>weight は制約の重みを表す．重みは，制約の重要性を表す正数もしくは文字列 'inf' である．
ここで 'inf' は無限大を表し，絶対制約を定義するときに用いられる．
重みは省略することができ，その場合の既定値は 1である．</p>
</li>
<li><p>rhs は制約の右辺定数(right hand side)を表す．
右辺定数は，制約の右辺を表す定数（整数値）である．
右辺定数は省略することができ，その場合の既定値は 0 である．</p>
</li>
<li><p>direction は制約の向きを表す．
制約の向きは，
'&lt;=' ,   '&gt;=' ,   '=' のいずれかの文字列とする．既定値は  '&lt;=' である．</p>
</li>
</ul>
<p>上の引数はすべて Linear クラスの属性となる．最適化を行った後では，制約の左辺の評価値が属性として参照可能になる．</p>
<ul>
<li>lhs は制約の左辺の値を表す．これは最適化によって得られた変数の値を左辺に代入したときの評価値である．
最適化を行う前には 0 が代入されている</li>
</ul>
<p>Linear クラスは，以下のメソッドをもつ．</p>
<ul>
<li><p>addTerms(coeffs, vars，values) は，線形制約の左辺に1つもしくは複数の項を追加する．</p>
<p>addTerms メソッドの引数の意味は以下の通り．</p>
<ul>
<li>coeffs は追加する項の係数もしくは係数リスト．係数もしくはリストの要素は整数．</li>
<li>vars は追加する項の変数インスタンスもしくはの変数インスタンスのリスト．リストの場合には，リストcoeffsと同じ長さをもつ必要がある．</li>
<li>values は追加する項の値もしは値のリスト．リストの場合には，リストcoeffsと同じ長さをもつ必要がある．
　</li>
</ul>
<p>addTerms メソッドは，1つの項を追加するか，複数の項を一度に追加する．1つの項を追加する場合には，引数の係数は整数値，変数は変数インスタンスで与え，値は変数の領域の要素とする．複数の項を一度に追加する場合には，同じ長さをもつ，係数，変数インスタンス，値のリストで与える．</p>
</li>
</ul>
<p>たとえば，項をもたない線形制約インスタンス L に対して，</p>

<pre><code>L.addTerms(1, y, 'A')</code></pre>
<p>と1つの項を追加すると，制約の左辺は</p>

<pre><code>1 x[y, 'A']</code></pre>
<p>となる．ここで  x は値変数（ y が 'A' になるとき 1，それ以外のとき 0 の仮想の変数）を表す．</p>
<p>同様に，項をもたない線形制約インスタンス  L に対して，</p>

<pre><code>L.addTerms([2, 3, 1], [y, y, z], ['C', 'D', 'C'])</code></pre>
<p>と3つの項を同時に追加すると，制約の左辺は以下のようになる．</p>

<pre><code> 2 x[y,'C']  + 3 x[y,'D'] + 1 x[z,'C']</code></pre>
<ul>
<li><p>setRhs(rhs) は線形制約の右辺定数を  rhs に設定する．引数は整数値であり，既定値は 0 である．</p>
</li>
<li><p>setDirection(dir) は制約の向きを設定する．引数  dir は
'&lt;=' ,   '&gt;=' ,   '=' のいずれかの文字列とする．既定値は  '&lt;=' である．</p>
</li>
<li><p>setWeight(weight) は制約の重みを  weight に設定する．引数は正数値もしくは文字列  'inf' である．
ここで  'inf' は無限大を表し，絶対制約を定義するときに用いられる．</p>
</li>
</ul>
<p>また，線形制約クラス  Linear は，制約の情報を文字列として返すことができる．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Linear" class="doc_header"><code>class</code> <code>Linear</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L427" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Linear</code>(<strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>weight</code></strong>=<em><code>1</code></em>, <strong><code>rhs</code></strong>=<em><code>0</code></em>, <strong><code>direction</code></strong>=<em><code>'&lt;='</code></em>) :: <a href="/scoptrial/14scop.html#Constraint"><code>Constraint</code></a></p>
</blockquote>
<p>Linear ( name, weight=1, rhs=0, direction="&lt;=" )
Linear constraint constructor.</p>
<p>Arguments:</p>
<ul>
<li>name: Name of linear constraint.</li>
<li>weight (optiona): Positive integer representing importance of constraint.</li>
<li>rhs: Right-hand-side constant of linear constraint.</li>
<li>direction: Rirection (or sense) of linear constraint; "&lt;=" (default) or "&gt;=" or "=".</li>
</ul>
<p>Attributes:</p>
<ul>
<li>name: Name of linear constraint.</li>
<li>weight (optional): Positive integer representing importance of constraint.</li>
<li>rhs: Right-hand-side constant of linear constraint.</li>
<li>lhs: Left-hand-side constant of linear constraint.</li>
<li>direction: Direction (or sense) of linear constraint; "&lt;=" (default) or "&gt;=" or "=".</li>
<li>terms: List of terms in left-hand-side of constraint. Each term is a tuple of coeffcient,variable and its value.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Linear&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;">Linear&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;<a class="anchor-link" href="#Linear&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;a linear constraint&quot;</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;&lt;=&quot;</span> <span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>a_linear_constraint: weight= 1 type=linear 3(x,A) &lt;=10

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;a linear constraint&quot;</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="mf">10.56</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span> <span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    
<span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">L</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="mf">3.1415</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Right-hand-side must be an integer.
Coefficient must be an integer.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2&#27425;&#21046;&#32004;&#12463;&#12521;&#12473;">2&#27425;&#21046;&#32004;&#12463;&#12521;&#12473;<a class="anchor-link" href="#2&#27425;&#21046;&#32004;&#12463;&#12521;&#12473;"> </a></h2><p>SCOPでは（非凸の）2次関数を左辺にもつ制約（2次制約）も扱うことができる．</p>
<p>2次制約は，
$$
  2次項1 + 2次項2 + \cdots  制約の方向 (\leq, \geq, =) 右辺定数
$$
の形で与えられる．ここで2次項は，
$$
 係数 \times x[変数1,値1] \times  x[変数2,値2] 
$$
で与えられる．</p>
<p>2次制約クラス  Quadratic のインスタンスは，以下のように生成する．</p>
<div class="highlight"><pre><span></span><span class="mi">2</span><span class="n">次制約インスタンス</span><span class="o">=</span><span class="n">Quadratic</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">)</span>
</pre></div>
<p>2次制約クラスの引数と属性は，線形制約クラス  Linear と同じである．</p>
<p>Quadratic クラスは，以下のメソッドをもつ．</p>
<div class="highlight"><pre><span></span><span class="n">addTerms</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="n">vars1</span><span class="p">,</span><span class="n">values1</span><span class="p">,</span><span class="n">vars2</span><span class="p">,</span><span class="n">values2</span><span class="p">)</span> <span class="n">は2次制約の左辺に2つの変数の積から成る項を追加する</span><span class="err">．</span>
</pre></div>
<p>2次制約に対する addTerms メソッドの引数は以下の通り．</p>
<ul>
<li>coeffs は追加する項の係数もしくは係数のリスト．係数もしくはリストの要素は整数．</li>
<li>vars1 は追加する項の第1変数インスタンスもしくは変数インスタンスのリスト． リストの場合には，リスト  coeffs と同じ長さをもつ必要がある．</li>
<li>values1 は追加する項の第1変数の値もしくは値のリスト． リストの場合には，リスト coeffs と同じ長さをもつ必要がある．</li>
<li>vars2 は追加する項の第2変数の変数インスタンスもしくは変数インスタンスのリスト． リストの場合には，リスト  coeffs と同じ長さをもつ必要がある．</li>
<li>values2 は追加する項の第2変数の値もしくは値のリスト． リストの場合には， リスト coeffs と同じ長さをもつ必要がある．</li>
</ul>
<p>addTerms メソッドは，1つの項を追加するか，複数の項を一度に追加する．
1つの項を追加する場合には，
引数の係数は整数値，変数は変数インスタンスで与え，値は変数の領域の要素とする．
複数の項を一度に追加する場合には，同じ長さをもつ，係数，変数インスタンス，値のリストで与える．</p>
<p>たとえば，項をもたない2次制約インスタンス  Q に対して，</p>
<div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
<p>と1つの項を追加すると，制約の左辺は</p>
<div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
</pre></div>
<p>となる．</p>
<p>同様に，項をもたない2次制約インスタンス  Q に対して，</p>
<div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">addTerms</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
</pre></div>
<p>と3つの項を同時に追加すると，制約の左辺は以下のようになる．</p>
<div class="highlight"><pre><span></span><span class="mi">2</span> <span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span> <span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="n">x</span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
</pre></div>
<ul>
<li><p>setRhs(rhs) は2次制約の右辺定数を  rhs に設定する．引数は整数値であり，既定値は 0 である．</p>
</li>
<li><p>setDirection(dir) は制約の向きを設定する．引数  dir は
'&lt;=' ,   '&gt;=' ,   '=' のいずれかの文字列とする．既定値は  '&lt;=' である．</p>
</li>
<li><p>setWeight(weight) は制約の重みを設定する．引数は正数値もしくは文字列  'inf' である．
'inf' は無限大を表し，絶対制約を定義するときに用いられる．</p>
</li>
</ul>
<p>また，2次制約クラス  Quadratic は，制約の情報を文字列として返すことができる．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Quadratic" class="doc_header"><code>class</code> <code>Quadratic</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L530" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Quadratic</code>(<strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>weight</code></strong>=<em><code>1</code></em>, <strong><code>rhs</code></strong>=<em><code>0</code></em>, <strong><code>direction</code></strong>=<em><code>'&lt;='</code></em>) :: <a href="/scoptrial/14scop.html#Constraint"><code>Constraint</code></a></p>
</blockquote>
<p>Quadratic ( name, weight=1, rhs=0, direction="&lt;=" )
Quadratic constraint constructor.</p>
<p>Arguments:</p>
<ul>
<li>name: Name of quadratic constraint.</li>
<li>weight (optional): Positive integer representing importance of constraint.</li>
<li>rhs: Right-hand-side constant of linear constraint.</li>
<li>direction: Direction (or sense) of linear constraint; "&lt;=" (default) or "&gt;=" or "=".</li>
</ul>
<p>Attributes:</p>
<ul>
<li>name: Name of quadratic constraint.</li>
<li>weight (optiona): Positive integer representing importance of constraint.</li>
<li>rhs: Right-hand-side constant of linear constraint.</li>
<li>lhs: Left-hand-side constant of linear constraint.</li>
<li>direction: Direction (or sense) of linear constraint; "&lt;=" (default) or "&gt;=" or "=".</li>
<li>terms: List of terms in left-hand-side of constraint. Each term is a tuple of coeffcient, variable1, value1, variable2 and value2.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Quadratic&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;">Quadratic&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;<a class="anchor-link" href="#Quadratic&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">Quadratic</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;a quadratic constraint&quot;</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;&lt;=&quot;</span> <span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">addTerms</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>a_quadratic_constraint: weight=1 type=quadratic 3(x,A)(y,B) 9(x,B)(y,C) &lt;=10

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#30456;&#30064;&#21046;&#32004;&#12463;&#12521;&#12473;">&#30456;&#30064;&#21046;&#32004;&#12463;&#12521;&#12473;<a class="anchor-link" href="#&#30456;&#30064;&#21046;&#32004;&#12463;&#12521;&#12473;"> </a></h2><p>相異制約は，変数の集合に対し, 集合に含まれる変数すべてが異なる値を
とらなくてはならないことを規定する．
これは組合せ的な構造に対する制約であり，制約最適化の特徴的な制約である．</p>
<p>SCOPにおいては，値が同一であるかどうかは，値の名称ではなく，
変数のとりえる値の集合（領域）を表したリストにおける\underline{順番（インデックス）}によって決定される.
たとえば, 変数  var1 および  var2 の領域がそれぞれ  ['A','B'] ならびに  ['B','A'] であったとき，
変数  var1 の値   'A', 'B'  の順番はそれぞれ 0 と 1， 
変数  var2 の値   'A', 'B'  の順番はそれぞれ 1 と 0 となる．
したがって，相異制約を用いる際には，変数に同じ領域を与えることが（混乱を避けるという意味で）推奨される．</p>
<p>相異制約クラス  Alldiff のインスタンスは，以下のように生成する．</p>
<div class="highlight"><pre><span></span><span class="n">相異制約インスタンス</span> <span class="o">=</span> <span class="n">Alldiff</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">varlist</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
<p>引数の名前と既定値は以下の通り．</p>
<ul>
<li><p>name は制約名を与える．</p>
</li>
<li><p>varlist は相異制約に含まれる変数インスタンスのリストを与える．
これは，値の順番が異なることを要求される変数のリストであり，省略も可能である．
その場合の既定値は，空のリストとなる．
ここで追加する変数は，モデルクラスに追加された変数である必要がある．</p>
</li>
<li><p>weight は制約の重みを与える．</p>
</li>
</ul>
<p>相異制約の制約名と重みについては，線形制約クラス  Linear と同じように設定する．
上の引数は  Alldiff クラスの属性でもある．その他の属性として最適化した後で得られる式の評価値がある．</p>
<ul>
<li>lhs は左辺(left hand side)の評価値を表し，最適化された後に，同じ値の番号（インデックス）をもつ変数の数が代入される．</li>
</ul>
<p>Alldiff クラスは，以下のメソッドをもつ．</p>
<ul>
<li><p>addVariable(var) は相異制約に1つの変数インスタンス  var を追加する．</p>
</li>
<li><p>addVariables(varlist) は相異制約の変数インスタンスを複数同時に（リスト  varlist として）追加する．</p>
</li>
<li><p>setWeight(weight) は制約の重みを設定する．引数は正数値もしくは文字列  'inf' である．  'inf' は無限大を表し，絶対制約を定義するときに用いられる．</p>
</li>
</ul>
<p>また，相異制約クラス  Alldiff は，制約の情報を文字列として返すことができる．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Alldiff" class="doc_header"><code>class</code> <code>Alldiff</code><a href="https://github.com/mikiokubo/scoptrial/tree/master/scoptrial/scop.py#L644" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Alldiff</code>(<strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>varlist</code></strong>=<em><code>None</code></em>, <strong><code>weight</code></strong>=<em><code>1</code></em>) :: <a href="/scoptrial/14scop.html#Constraint"><code>Constraint</code></a></p>
</blockquote>
<p>Alldiff ( name=None,varlist=None,weight=1 )
Alldiff type constraint constructor.</p>
<p>Arguments:</p>
<ul>
<li>name: Name of all-different type constraint.</li>
<li>varlist (optional): List of variables that must have differennt value indices.</li>
<li>weight (optional): Positive integer representing importance of constraint.</li>
</ul>
<p>Attributes:</p>
<ul>
<li>name: Name of all-different type  constraint.</li>
<li>varlist (optional): List of variables that must have differennt value indices.</li>
<li><p>lhs: Left-hand-side constant of linear constraint.</p>
</li>
<li><p>weight (optional): Positive integer representing importance of constraint.</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alldiff&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;">Alldiff&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;<a class="anchor-link" href="#Alldiff&#12463;&#12521;&#12473;&#12398;&#20351;&#29992;&#20363;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Alldiff</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;a alldiff constraint&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">addVariables</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>a_alldiff_constraint: weight= 1 type=alldiff  y x ; 

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#20363;&#38988;">&#20363;&#38988;<a class="anchor-link" href="#&#20363;&#38988;"> </a></h2><p>ここでは，仕事割り当ての例題を通してSCOPの基本的な使用法を解説する．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20181;&#20107;&#12398;&#21106;&#24403;1">&#20181;&#20107;&#12398;&#21106;&#24403;1<a class="anchor-link" href="#&#20181;&#20107;&#12398;&#21106;&#24403;1"> </a></h3><p>あなたは，土木事務所の親方だ．いま，3人の作業員 A,B,C を3つの仕事 0,1,2 に割り当てる必要がある．
すべての仕事には，1人の作業員を割り当てる必要があるが，
作業員と仕事には相性があり，割り当てにかかる費用（単位は万円）は，以下のようになっている．</p>
<table>
<thead><tr>
<th>作業員</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>仕事</td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>A</td>
<td>15</td>
<td>20</td>
<td>30</td>
</tr>
</tbody>
</table>
<p>B       |  7  |  15  |  12   |
|C       |  25  |  10  |  13  |</p>
<p>総費用を最小にするように作業員に仕事を割り振るには，どのようにしたら良いだろうか？</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Example 1 (Assignment Problem):</span>
<span class="sd">Three jobs (0,1,2) must be assigned to three workers (A,B,C)</span>
<span class="sd">so that each job is assigned to exactly one worker.</span>
<span class="sd">The cost matrix is represented by the list of lists</span>
<span class="sd">Cost=[[15, 20, 30],</span>
<span class="sd">      [7, 15, 12],</span>
<span class="sd">      [25,10,13]],</span>
<span class="sd">where rows of the matrix are workers, and columns are jobs.</span>
<span class="sd">Find the minimum cost assignment of workers to jobs.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">workers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">Jobs</span>   <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Cost</span><span class="o">=</span><span class="p">{</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">20</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">30</span><span class="p">,</span>
       <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">12</span><span class="p">,</span>
       <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">25</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">13</span> <span class="p">}</span>

<span class="n">m</span><span class="o">=</span><span class="n">Model</span><span class="p">()</span>
<span class="n">x</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="n">Jobs</span><span class="p">)</span>

<span class="n">xlist</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
    <span class="n">xlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">con1</span><span class="o">=</span><span class="n">Alldiff</span><span class="p">(</span><span class="s1">&#39;AD&#39;</span><span class="p">,</span><span class="n">xlist</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="n">con2</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="s1">&#39;linear_constraint&#39;</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">rhs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Jobs</span><span class="p">:</span>
        <span class="n">con2</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="n">Cost</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">j</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">con1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">con2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">Params</span><span class="o">.</span><span class="n">TimeLimit</span><span class="o">=</span><span class="mi">1</span>
<span class="n">sol</span><span class="p">,</span><span class="n">violated</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>

<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">Status</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solution&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sol</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;violated constraint(s)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">violated</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">violated</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: 
number of variables = 3  
number of constraints= 2  
variable A:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = None 
variable B:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = None 
variable C:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = None 
AD: weight= inf type=alldiff  C A B ;  :LHS =0  
linear_constraint: weight= 1 type=linear 15(A,0) 20(A,1) 30(A,2) 7(B,0) 15(B,1) 12(B,2) 25(C,0) 10(C,1) 13(C,2) &lt;=0 :LHS =0 

 ================ Now solving the problem ================ 

solution
A 0
B 2
C 1
violated constraint(s)
linear_constraint 37
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20181;&#20107;&#12398;&#21106;&#24403;2">&#20181;&#20107;&#12398;&#21106;&#24403;2<a class="anchor-link" href="#&#20181;&#20107;&#12398;&#21106;&#24403;2"> </a></h3><p>あなたは土木事務所の親方だ．今度は，5人の作業員 A,B,C,D,Eを3つの仕事 $0,1,2$ に割り当てる必要がある．
ただし，各仕事にかかる作業員の最低人数が与えられており，それぞれ $1,2,2$人必要であり，
割り当ての際の費用（単位は万円）は，以下のようになっているものとする．</p>
<table>
<thead><tr>
<th>作業員</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>仕事</td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>A</td>
<td>15</td>
<td>20</td>
<td>30</td>
</tr>
<tr>
<td>B</td>
<td>7</td>
<td>15</td>
<td>12</td>
</tr>
<tr>
<td>C</td>
<td>25</td>
<td>10</td>
<td>13</td>
</tr>
<tr>
<td>D</td>
<td>15</td>
<td>18</td>
<td>3</td>
</tr>
<tr>
<td>E</td>
<td>5</td>
<td>12</td>
<td>17</td>
</tr>
</tbody>
</table>
<p>さて，誰にどの仕事を割り振れば費用が最小になるだろうか？</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example 2 (Generalized Assignment Problem):</span>
<span class="sd">Three jobs (0,1,2) must be assigned to five workers (A,B,C,D,E).</span>
<span class="sd">The numbers of workers that must be assigned to jobs 0,1 and 2 are 1,1 and 2, respectively. </span>
<span class="sd">The cost matrix is represented by the list of lists  </span>
<span class="sd">Cost=[[15, 20, 30],</span>
<span class="sd">[7, 15, 12],</span>
<span class="sd">[25,10,13],</span>
<span class="sd">[15,18,3],</span>
<span class="sd">[5,12,17]]</span>
<span class="sd">where rows are workers, and columns are jobs.</span>
<span class="sd">Find the minimum cost assignment of workers to jobs.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">m</span><span class="o">=</span><span class="n">Model</span><span class="p">()</span>
<span class="n">workers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">Jobs</span>   <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Cost</span><span class="o">=</span><span class="p">{</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">20</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">30</span><span class="p">,</span>
       <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">12</span><span class="p">,</span>
       <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">25</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">13</span><span class="p">,</span>
       <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">18</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
       <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">17</span>
       <span class="p">}</span>
<span class="n">LB</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="n">x</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="n">Jobs</span><span class="p">)</span>
<span class="n">LBC</span><span class="o">=</span><span class="p">{}</span> <span class="c1">#dictionary for keeping lower bound constraints</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Jobs</span><span class="p">:</span>
    <span class="n">LBC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="s1">&#39;LB</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="s1">&#39;inf&#39;</span><span class="p">,</span><span class="n">LB</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
        <span class="n">LBC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">j</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">LBC</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">obj</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="n">Cost</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">j</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">Params</span><span class="o">.</span><span class="n">TimeLimit</span><span class="o">=</span><span class="mi">1</span>
<span class="n">sol</span><span class="p">,</span><span class="n">violated</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">Status</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solution&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sol</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;violated constraint(s)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">violated</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">violated</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 ================ Now solving the problem ================ 

Model: 
number of variables = 5  
number of constraints= 4  
variable A:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 1 
variable B:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 2 
variable C:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 1 
variable D:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 2 
variable E:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 0 
LB0: weight= inf type=linear 1(A,0) 1(B,0) 1(C,0) 1(D,0) 1(E,0) &gt;=1 :LHS =1  
LB1: weight= inf type=linear 1(A,1) 1(B,1) 1(C,1) 1(D,1) 1(E,1) &gt;=2 :LHS =2  
LB2: weight= inf type=linear 1(A,2) 1(B,2) 1(C,2) 1(D,2) 1(E,2) &gt;=2 :LHS =2  
obj: weight= 1 type=linear 15(A,0) 20(A,1) 30(A,2) 7(B,0) 15(B,1) 12(B,2) 25(C,0) 10(C,1) 13(C,2) 15(D,0) 18(D,1) 3(D,2) 5(E,0) 12(E,1) 17(E,2) &lt;=0 :LHS =50 
solution
A 1
B 2
C 1
D 2
E 0
violated constraint(s)
obj 50
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20181;&#20107;&#12398;&#21106;&#24403;3">&#20181;&#20107;&#12398;&#21106;&#24403;3<a class="anchor-link" href="#&#20181;&#20107;&#12398;&#21106;&#24403;3"> </a></h3><p>上の例題と同じ状況で，仕事を割り振ろうとしたところ，作業員 A と C は仲が悪く，
一緒に仕事をさせると喧嘩を始めることが判明した．
作業員 A と C を同じ仕事に割り振らないようにするには，どうしたら良いかを考えてみる．</p>
<p>この問題は，追加された作業員 A と C を同じ仕事に割り当てることを禁止する制約を記述するだけで解決できる．
これは，2次制約（重みは $100$）として記述する．</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example 3 (Variation of Generalized Assignment Problem):</span>
<span class="sd">Three jobs (0,1,2) must be assigned to five workers (A,B,C,D,E).</span>
<span class="sd">The minimum numbers of workers that must be assigned to jobs 0,1 and 2 are 1,2 and 2, respectively.</span>
<span class="sd">This lower bound is represented by a dictionary:</span>
<span class="sd">LB={0: 1,</span>
<span class="sd">    1: 2,</span>
<span class="sd">    2: 2</span>
<span class="sd">    }</span>
<span class="sd">where keys are jobs and values are lower bounds.</span>
<span class="sd">The cost matrix is represented by a dictionary:</span>
<span class="sd">Cost={ (&quot;A&quot;,0):15, (&quot;A&quot;,1):20, (&quot;A&quot;,2):30,</span>
<span class="sd">       (&quot;B&quot;,0): 7, (&quot;B&quot;,1):15, (&quot;B&quot;,2):12,</span>
<span class="sd">       (&quot;C&quot;,0):25, (&quot;C&quot;,1):10, (&quot;C&quot;,2):13,</span>
<span class="sd">       (&quot;D&quot;,0):15, (&quot;D&quot;,1):18, (&quot;D&quot;,2): 3,</span>
<span class="sd">       (&quot;E&quot;,0): 5, (&quot;E&quot;,1):12, (&quot;E&quot;,2):17</span>
<span class="sd">       }</span>
<span class="sd">where keys are tuples of workers and jobs, and values are costs.</span>
<span class="sd">We add an additional condition: worker A cannot do the job with worker C.</span>
<span class="sd">Find the minimum cost assignment of workers to jobs.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">m</span><span class="o">=</span><span class="n">Model</span><span class="p">()</span>
<span class="n">workers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">]</span>
<span class="n">Jobs</span>   <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Cost</span><span class="o">=</span><span class="p">{</span> <span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">20</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">30</span><span class="p">,</span>
       <span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">12</span><span class="p">,</span>
       <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">25</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">13</span><span class="p">,</span>
       <span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">18</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
       <span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">17</span>
       <span class="p">}</span>
<span class="n">LB</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="n">x</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Jobs</span><span class="p">)</span>
<span class="n">LBC</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Jobs</span><span class="p">:</span>
    <span class="n">LBC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="s2">&quot;LB</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="s2">&quot;inf&quot;</span><span class="p">,</span><span class="n">LB</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
        <span class="n">LBC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">j</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">LBC</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">obj</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="s2">&quot;obj&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Jobs</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="n">Cost</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">j</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="n">conf</span><span class="o">=</span><span class="n">Quadratic</span><span class="p">(</span><span class="s2">&quot;conflict&quot;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Jobs</span><span class="p">:</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">addTerms</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">],</span><span class="n">j</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">],</span><span class="n">j</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">Params</span><span class="o">.</span><span class="n">TimeLimit</span><span class="o">=</span><span class="mi">1</span>
<span class="n">sol</span><span class="p">,</span><span class="n">violated</span><span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">Status</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;solution&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sol</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">violated</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">violated</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 ================ Now solving the problem ================ 

Model: 
number of variables = 5  
number of constraints= 5  
variable A:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 0 
variable B:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 2 
variable C:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 1 
variable D:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 2 
variable E:[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;] = 1 
LB0: weight= inf type=linear 1(A,0) 1(B,0) 1(C,0) 1(D,0) 1(E,0) &gt;=1 :LHS =1  
LB1: weight= inf type=linear 1(A,1) 1(B,1) 1(C,1) 1(D,1) 1(E,1) &gt;=2 :LHS =2  
LB2: weight= inf type=linear 1(A,2) 1(B,2) 1(C,2) 1(D,2) 1(E,2) &gt;=2 :LHS =2  
obj: weight= 1 type=linear 15(A,0) 20(A,1) 30(A,2) 7(B,0) 15(B,1) 12(B,2) 25(C,0) 10(C,1) 13(C,2) 15(D,0) 18(D,1) 3(D,2) 5(E,0) 12(E,1) 17(E,2) &lt;=0 :LHS =52  
conflict: weight=100 type=quadratic 1(A,0)(C,0) 1(A,1)(C,1) 1(A,2)(C,2) =0 :LHS =0 
solution
A 0
B 2
C 1
D 2
E 1
obj 52
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#32244;&#32722;&#21839;&#38988;">&#32244;&#32722;&#21839;&#38988;<a class="anchor-link" href="#&#32244;&#32722;&#21839;&#38988;"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#22810;&#21046;&#32004;&#12490;&#12483;&#12503;&#12469;&#12483;&#12463;&#21839;&#38988;">&#22810;&#21046;&#32004;&#12490;&#12483;&#12503;&#12469;&#12483;&#12463;&#21839;&#38988;<a class="anchor-link" href="#&#22810;&#21046;&#32004;&#12490;&#12483;&#12503;&#12469;&#12483;&#12463;&#21839;&#38988;"> </a></h3><p>あなたは，ぬいぐるみ専門の泥棒だ．
ある晩，あなたは高級ぬいぐるみ店にこっそり忍び込んで，盗む物を選んでいる．
狙いはもちろん，マニアの間で高額で取り引きされているクマさん人形だ．
クマさん人形は，現在 4体販売されていて，
それらの値段と重さと容積は，以下のリストで与えられている．</p>
<div class="highlight"><pre><span></span><span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>                     <span class="c1">#価値</span>
<span class="n">a</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3000</span><span class="p">,</span><span class="mi">3500</span><span class="p">,</span><span class="mi">5100</span><span class="p">,</span><span class="mi">7200</span><span class="p">]]</span> <span class="c1">#重さと容積</span>
</pre></div>
<p>あなたは，転売価格の合計が最大になるようにクマさん人形を選んで逃げようと思っているが，
あなたが逃走用に愛用しているナップサックはとても古く，
7kgより重い荷物を入れると，底がぬけてしまうし，10000立方センチメートル（10リットル）を超えた荷物を入れると破けてしまう．</p>
<p>さて，どのクマさん人形をもって逃げれば良いだろうか？</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#26368;&#22823;&#23433;&#23450;&#38598;&#21512;&#21839;&#38988;">&#26368;&#22823;&#23433;&#23450;&#38598;&#21512;&#21839;&#38988;<a class="anchor-link" href="#&#26368;&#22823;&#23433;&#23450;&#38598;&#21512;&#21839;&#38988;"> </a></h3><p>あなたは $6$人のお友達から何人か選んで一緒にピクニックに行こうと思っている．
しかし，グラフ上で隣接している（線で結ばれている）人同士はとても仲が悪く，彼らが一緒にピクニックに
行くとせっかくの楽しいピクニックが台無しになってしまう．
なるべくたくさんの仲間でピクニックに行くには誰を誘えばいいんだろう？</p>
<p>ただし，グラフの隣接点の情報は以下のリストで与えられているものとする．</p>

<pre><code>adj=[[2],[3],[0,3,4,5],[1,2,5],[2],[2,3]]</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#12464;&#12521;&#12501;&#24425;&#33394;&#21839;&#38988;">&#12464;&#12521;&#12501;&#24425;&#33394;&#21839;&#38988;<a class="anchor-link" href="#&#12464;&#12521;&#12501;&#24425;&#33394;&#21839;&#38988;"> </a></h3><p>今度は，同じお友達のクラス分けで悩んでいる．
お友達同士で仲が悪い組は，グラフ上で隣接している．
仲が悪いお友達を同じクラスに入れると喧嘩を始めてしまう．
なるべく少ないクラスに分けるには，どのようにすればいいんだろう？</p>
<p>ただし，グラフの隣接点の情報は以下のリストで与えられているものとする．</p>

<pre><code>adj=[[2],[3],[0,3,4,5],[1,2,5],[2],[2,3]]</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#12464;&#12521;&#12501;&#20998;&#21106;&#21839;&#38988;">&#12464;&#12521;&#12501;&#20998;&#21106;&#21839;&#38988;<a class="anchor-link" href="#&#12464;&#12521;&#12501;&#20998;&#21106;&#21839;&#38988;"> </a></h3><p>今度は，同じ$6$人のお友達を2つのチームに分けてミニサッカーをしようとしている．
もちろん，公平を期すために，同じ人数になるように3人ずつに分ける．
ただし，仲が悪いお友達が同じチームになることは極力避けたいと考えている．
さて，どのようにチーム分けをしたら良いだろうか？</p>
<p>ただし，中の悪い同士を表すグラフの隣接点の情報は以下のリストで与えられているものとする．</p>
<div class="highlight"><pre><span></span><span class="n">adj</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#24033;&#22238;&#12475;&#12540;&#12523;&#12473;&#12510;&#12531;&#21839;&#38988;">&#24033;&#22238;&#12475;&#12540;&#12523;&#12473;&#12510;&#12531;&#21839;&#38988;<a class="anchor-link" href="#&#24033;&#22238;&#12475;&#12540;&#12523;&#12473;&#12510;&#12531;&#21839;&#38988;"> </a></h3><p>あなたは休暇を利用してヨーロッパめぐりをしようと考えている．
現在スイスのチューリッヒに宿を構えているあなたの目的は，
スペインのマドリッドで闘牛を見ること，
イギリスのロンドンでビックベンを見物すること，
イタリアのローマでコロシアムを見ること，
ドイツのベルリンで本場のビールを飲むことである．</p>
<p>あなたはレンタルヘリコプターを借りてまわることにしたが，
移動距離に比例した高額なレンタル料を支払わなければならない．
したがって，
あなたはチューリッヒ (T) を出発した後，
なるべく短い距離で他の $4$つの都市 マドリッド(M)，ロンドン(L)，ローマ(R)，ベルリン(B) を経由し，
再びチューリッヒに帰って来ようと考えた．
都市の間の移動距離を測ってみたところ，以下のようになっていることがわかった．</p>
<div class="highlight"><pre><span></span><span class="n">cities</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">,</span><span class="s2">&quot;L&quot;</span><span class="p">,</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
<span class="n">d</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">476</span><span class="p">,</span><span class="mi">774</span><span class="p">,</span><span class="mi">434</span><span class="p">,</span><span class="mi">408</span><span class="p">],</span>
   <span class="p">[</span><span class="mi">476</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">784</span><span class="p">,</span><span class="mi">894</span><span class="p">,</span><span class="mi">569</span><span class="p">],</span>
   <span class="p">[</span><span class="mi">774</span><span class="p">,</span><span class="mi">784</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">852</span><span class="p">,</span><span class="mi">1154</span><span class="p">],</span>
   <span class="p">[</span><span class="mi">434</span><span class="p">,</span><span class="mi">894</span><span class="p">,</span><span class="mi">852</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">569</span><span class="p">],</span>
   <span class="p">[</span><span class="mi">408</span><span class="p">,</span><span class="mi">569</span><span class="p">,</span><span class="mi">1154</span><span class="p">,</span><span class="mi">569</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
<p>さて，どのような順序で旅行すれば，移動距離が最小になるだろうか?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#12499;&#12531;&#12497;&#12483;&#12461;&#12531;&#12464;&#21839;&#38988;">&#12499;&#12531;&#12497;&#12483;&#12461;&#12531;&#12464;&#21839;&#38988;<a class="anchor-link" href="#&#12499;&#12531;&#12497;&#12483;&#12461;&#12531;&#12464;&#21839;&#38988;"> </a></h3><p>あなたは，大企業の箱詰め担当部長だ．あなたの仕事は，色々な大きさのものを，決められた大きさの箱に「上手に」詰めることである．
この際，使う箱の数をなるべく少なくすることが，あなたの目標だ．
（なぜって，あなたの会社が利用している宅配業者では，運賃は箱の数に比例して決められるから．）
1つの箱に詰められる荷物の上限は $7$kgと決まっており，荷物の重さはのリストは
[6,5,4,3,1,2] である．
しかも，あなたの会社で扱っている荷物は，どれも重たいものばかりなので，容積は気にする必要はない
（すなわち箱の容量は十分と仮定する）．
さて，どのように詰めて運んだら良いだろうか？</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#26368;&#36969;&#21270;&#29256;&#12398;$8$-&#12463;&#12452;&#12540;&#12531;&#21839;&#38988;">&#26368;&#36969;&#21270;&#29256;&#12398;$8$-&#12463;&#12452;&#12540;&#12531;&#21839;&#38988;<a class="anchor-link" href="#&#26368;&#36969;&#21270;&#29256;&#12398;$8$-&#12463;&#12452;&#12540;&#12531;&#21839;&#38988;"> </a></h3><p>$8 \times 8$ のチェス盤に $8$個のクイーンを置くことを考える．
チェスのクイーンとは，将棋の飛車と角の両方の動きができる最強の駒である．
$i$行 $j$列に置いたときの費用を $i \times j$ と定義したとき，
クイーンがお互いに取り合わないように置く配置の中で，費用の合計が最小になるような配置を求めよ．</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2&#27425;&#21106;&#24403;&#21839;&#38988;">2&#27425;&#21106;&#24403;&#21839;&#38988;<a class="anchor-link" href="#2&#27425;&#21106;&#24403;&#21839;&#38988;"> </a></h3><p>いま，3人のお友達が3箇所の家に住もうとしている．
3人は毎週何回か重要な打ち合わせをする必要があり，打ち合わせの頻度は，リストのリスト．</p>
<div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
<p>として与えられている．</p>
<p>また，家の間の移動距離もリストのリスト</p>
<div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
<p>として与えられているものとする．</p>
<p>3人は打ち合わせのときに移動する距離を最小に
するような場所に住むことを希望している．さて，誰をどの家に割り当てたらよいのだろうか？</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#12471;&#12501;&#12488;&#12473;&#12465;&#12472;&#12517;&#12540;&#12522;&#12531;&#12464;-&#65288;&#38627;&#65289;">&#12471;&#12501;&#12488;&#12473;&#12465;&#12472;&#12517;&#12540;&#12522;&#12531;&#12464; &#65288;&#38627;&#65289;<a class="anchor-link" href="#&#12471;&#12501;&#12488;&#12473;&#12465;&#12472;&#12517;&#12540;&#12522;&#12531;&#12464;-&#65288;&#38627;&#65289;"> </a></h3><p>あなたは，24時間営業のハンバーガーショップのオーナーであり，スタッフの1週間のシフトを組むことに頭を悩ませている．
スタッフの時給は同じであると仮定したとき，以下の制約を満たすシフトを求めよ．</p>
<ul>
<li>1シフトは 8時間で，朝，昼，晩の3シフトの交代制とする．</li>
<li>3人のスタッフは，1日に高々1つのシフトしか行うことができない．</li>
<li>繰り返し行われる1週間のスケジュールの中で，スタッフは最低3日間は勤務しなければならない．</li>
<li>スタッフの夜勤は最大で4回とする．</li>
<li>各スタッフは1日以上休みを取る必要がある．</li>
<li>各シフトに割り当てられるスタッフの数は，ちょうど 1人でなければならない．</li>
<li>異なるシフトを翌日に行ってはいけない．（すなわち異なるシフトに移るときには，必ず休日を入れる必要がある．）</li>
<li>シフト2, 3は，少なくとも2日間は連続で行わなければならない．</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#36554;&#12398;&#25237;&#20837;&#38918;&#27770;&#23450;-&#65288;&#38627;&#65289;">&#36554;&#12398;&#25237;&#20837;&#38918;&#27770;&#23450; &#65288;&#38627;&#65289;<a class="anchor-link" href="#&#36554;&#12398;&#25237;&#20837;&#38918;&#27770;&#23450;-&#65288;&#38627;&#65289;"> </a></h3><p>コンベア上に一直線に並んだ車の生産ラインを考える．
このラインは，幾つかの作業場から構成され，それぞれの作業場では異なる作業が行われる．
いま，4種類の車を同じ生産ラインで製造しており，それぞれをモデル $A,B,C,D$ とする．
本日の製造目標は，それぞれ $30,30,20,40$台である．</p>
<p>最初の作業場では，サンルーフの取り付けを行っており，これはモデル $B,C$ だけに必要な作業である．
次の作業場では，カーナビの取り付けが行われており，これはモデル $A,C$ だけに必要な作業である．
それぞれの作業場は長さをもち，
サンルーフ取り付けは車 $5$台分，カーナビ取り付けは車 $3$台分の長さをもつ．
また，作業場には作業員が割り当てられており，サンルーフ取り付けは $3$人，カーナビ取り付けは $2$人の
作業員が配置されており，作業場の長さを超えない範囲で別々に作業を行う．</p>
<p>作業場の範囲で作業が可能な車の投入順序を求めよ．</p>
<p>ヒント： 投入順序をうまく決めないと，作業場の範囲内で作業を完了することができない．
たとえば，$C,A,A,B,C$ の順で投入すると，
サンルーフ取り付けでは，3人の作業員がそれぞれモデル $C,B,C$ に対する作業を行うので
間に合うが，カーナビ取り付けでは， 2人の作業員では $C,A,A$ の3台の車の作業を終えることができない．</p>
<p>これは，作業場の容量制約とよばれ，サンルーフ取り付けの作業場では，
すべての連続する $5$台の車の中に，モデル $B,C$ が高々 $3$つ，
カーナビ取り付けの作業場では，
すべての連続する $3$台の車の中に，モデル $A,C$ が高々 $2$つ入っているという制約を課すことに相当する</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#27573;&#21462;&#12426;&#36027;&#29992;&#20184;&#12365;&#29983;&#29987;&#35336;&#30011;&#21839;&#38988;-&#65288;&#38627;&#65289;">&#27573;&#21462;&#12426;&#36027;&#29992;&#20184;&#12365;&#29983;&#29987;&#35336;&#30011;&#21839;&#38988; &#65288;&#38627;&#65289;<a class="anchor-link" href="#&#27573;&#21462;&#12426;&#36027;&#29992;&#20184;&#12365;&#29983;&#29987;&#35336;&#30011;&#21839;&#38988;-&#65288;&#38627;&#65289;"> </a></h3><p>１つの生産ラインでa,bの２種類の製品を生産している．各期に生産できる製品は1つであり，生産はバッチで行われるため生産量は決まっている（辞書S）．
5期の需要量（辞書D）を満たすように，生産計画（どの期にどの製品を生産するか）を作りたいのだが，製品の切り替えには段取り費用（辞書F）がかかる．
ただし，生産しないことを表すダミーの製品０があるものと仮定し，直前の期では何も生産していなかったものと仮定する．
生産すると生産量だけ在庫が増え，毎期需要分だけ在庫が減少する．
初期在庫（辞書I0）を与えたとき，各期の在庫量が上限（辞書UB）以下，下限（辞書LB)以上でなければいけないとしたとき，段取り費用の合計を最小にする生産計画をたてよ．</p>
<div class="highlight"><pre><span></span><span class="n">S</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">}</span> <span class="c1">#S[P,T]：単位生産量　</span>
<span class="n">UB</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">}</span> <span class="c1">#UB[p,t]：在庫量の上限 </span>
<span class="n">LB</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>  <span class="c1">#LB[p]：在庫量の下限</span>
<span class="n">I0</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">30</span><span class="p">}</span> <span class="c1">#I0[p]:初期在庫</span>

<span class="c1">#D[p,t]：需要量</span>
<span class="n">D</span><span class="o">=</span><span class="p">{(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">0</span><span class="p">,(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">0</span><span class="p">,(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">0</span><span class="p">,(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">0</span><span class="p">,(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span>
   <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">30</span><span class="p">,(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span>
   <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">20</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">20</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">10</span><span class="p">}</span>

<span class="c1">#F[p,q]: 製品p,q間の段取り費用</span>
<span class="n">F</span><span class="o">=</span><span class="p">{(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span>
   <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">):</span><span class="mi">30</span><span class="p">,</span>
   <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">):</span><span class="mi">10</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">):</span><span class="mi">10</span><span class="p">}</span>
</pre></div>

</div>
</div>
</div>
</div>
 

